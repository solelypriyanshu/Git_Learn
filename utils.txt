Utility functions of version 1